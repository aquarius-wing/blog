---
import Layout from '~/layouts/PageLayout.astro';
import { findLatestPosts } from '~/utils/blog';
import { getPermalink } from '~/utils/permalinks';
import { getFormattedDate } from '~/utils/utils';
import Image from '~/components/common/Image.astro';
import heroImage from '~/assets/images/hero-image.png';

const metadata = {
  title: 'Wingâ€™s Blog',
  ignoreTitleTemplate: true,
};

const count = 20;
const posts = await findLatestPosts({ count });
---

<Layout metadata={metadata}>
  <section class="max-w-3xl mx-auto px-4 sm:px-6 py-12 md:py-20">
    
    <!-- Bio / Header Section -->
    <header class="mb-8 md:mb-12 flex flex-col md:flex-row items-center gap-8 md:gap-12">
      <div class="flex-1">
        <h1 class="text-4xl md:text-5xl font-bold font-heading mb-6 tracking-tight dark:text-gray-100">
          <span class="text-accent dark:text-white highlight">ğŸ‘‹ Welcome to Wingâ€™s Blog</span>
        </h1>
        <p class="text-xl text-muted dark:text-slate-400 leading-relaxed">
          ä½ å¥½ï¼Œæˆ‘æ˜¯é€¸æ¸…ã€‚è¿™é‡Œæˆ‘ä¼šåˆ†äº«ä¸€äº›AIã€Web3ç­‰ç§‘æŠ€åšå®¢ï¼Œæ¬¢è¿å…³æ³¨ã€‚
        </p>
      </div>
    </header>

    <!-- Blog Posts List -->
    <section>
      <div class="flex items-center justify-between mb-8">
        <h2 class="text-xs font-bold tracking-widest text-gray-500 uppercase dark:text-gray-400">
          Latest Posts
        </h2>
      </div>

      <ul class="space-y-12">
        {posts.map((post) => (
          <li class="group">
            <div class="flex flex-col md:flex-row gap-6 md:gap-8">
              {post.image && (
                <a href={getPermalink(post.permalink, 'post')} class="block w-full md:w-52 shrink-0 self-start">
                  <Image
                    src={post.image}
                    alt={post.title}
                    class="w-full rounded-lg shadow-md bg-gray-100 dark:bg-slate-700 hover:opacity-90 transition duration-200"
                    width={400}
                    aspectRatio="16:9"
                    loading="lazy"
                  />
                </a>
              )}
              
              <div class="flex-1 flex flex-col py-2">
                <a 
                  href={getPermalink(post.permalink, 'post')} 
                  class="text-xl font-bold text-gray-900 dark:text-gray-100 group-hover:text-primary transition duration-200 mb-3"
                >
                  {post.title}
                </a>

                {post.excerpt && (
                  <p class="text-gray-600 dark:text-slate-400 leading-relaxed line-clamp-3 md:line-clamp-2 mb-4">
                    {post.excerpt}
                  </p>
                )}
                
                <div class="mt-auto flex items-center justify-start gap-2 text-sm text-gray-500 dark:text-gray-400">
                  {post.readingTime && (
                    <>
                      <span>{Math.ceil(post.readingTime)} min read</span>
                    </>
                  )}
                  {post.category && (
                    <>
                      <span class="text-gray-300 dark:text-gray-700">Â·</span>
                      <a href={getPermalink(post.category.slug, 'category')} class="hover:underline hover:text-gray-700 dark:hover:text-gray-300">
                        {post.category.title}
                      </a>
                    </>
                  )}
                  <time class="ml-auto" datetime={String(post.publishDate)}>
                    {getFormattedDate(post.publishDate)}
                  </time>
                </div>
              </div>
            </div>
          </li>
        ))}
      </ul>
    </section>

  </section>
</Layout>
